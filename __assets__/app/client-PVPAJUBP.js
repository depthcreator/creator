
var Vo=Symbol.for("#__initor__"),jo=Symbol.for("#__inited__"),Ho=Symbol.for("#type"),ne=Symbol.for("#__listeners__");function Mt(r){let t=typeof r;if(t=="number")return r;if(t=="string"){if(/^\d+fps$/.test(r))return 1e3/parseFloat(r);if(/^([-+]?[\d\.]+)s$/.test(r))return parseFloat(r)*1e3;if(/^([-+]?[\d\.]+)ms$/.test(r))return parseFloat(r)}return null}function oe(r,t,e){if(!r)return;let i=Object.getOwnPropertyDescriptor(r,t);return i||r==e?i||void 0:oe(Reflect.getPrototypeOf(r),t,e)}var ki=function(r,t,e){let i,s,n;for(;(i=e)&&(e=e.next);)(s=e.listener)&&(e.path&&s[e.path]?n=t?s[e.path].apply(s,t):s[e.path]():n=t?s.apply(e,t):s.call(e)),e.times&&--e.times<=0&&(i.next=e.next,e.listener=null)};function We(r,t,e,i){var s;let n,o,l;return n=r[ne]||(r[ne]={}),o=n[t]||(n[t]={}),l=o.tail||(o.tail=o.next={}),l.listener=e,l.path=i,o.tail=l.next={},l}function Rt(r,t,e){let i=We(r,t,e);return i.times=1,i}function Ii(r,t,e,i){let s,n,o=r[ne];if(!!o&&(s=o[t])){for(;(n=s)&&(s=s.next);)if(s==e||s.listener==e){n.next=s.next,s.listener=null;break}}}function Je(r,t,e){let i;(i=r[ne])&&(i[t]&&ki(t,e,i[t]),i.all&&ki(t,[t,e],i.all))}function On(r){let t;return r?(t=r.toIterable)?t.call(r):r:[]}var Di=Symbol.for("#__init__"),qo=Symbol.for("#__initor__"),Go=Symbol.for("#__inited__"),Mi=Symbol.for("#schedule"),Ye=Symbol.for("#frames"),le=Symbol.for("#interval"),Lt=Symbol.for("#stage"),xt=Symbol.for("#scheduled"),Fn=Symbol.for("#fps"),Ri=Symbol.for("#ticker"),Pn=globalThis.requestAnimationFrame||function(r){return setTimeout1(r,1e3/60)};var Uo=1/60,Li=class{constructor(t=null){this[Di](t)}[Di](t=null){var e;this.owner=t&&(e=t.owner)!==void 0?e:null,this.target=t&&(e=t.target)!==void 0?e:null,this.active=t&&(e=t.active)!==void 0?e:!1,this.value=t&&(e=t.value)!==void 0?e:void 0,this.skip=t&&(e=t.skip)!==void 0?e:0,this.last=t&&(e=t.last)!==void 0?e:0}tick(t,e){return this.last=this.owner[Ye],this.target.tick(this,e),1}update(t,e){let i=this.active,s=t.value;return this.value!=s&&(this.deactivate(),this.value=s),(this.value||i||e)&&this.activate(),this}queue(){this.owner.add(this)}activate(){return this.value===!0?this.owner.on("commit",this):this.value===!1||typeof this.value=="number"&&(this.value/(1e3/60)<=2?this.owner.on("raf",this):this[le]=globalThis.setInterval(this.queue.bind(this),this.value)),this.active=!0,this}deactivate(){return this.value===!0&&this.owner.un("commit",this),this.owner.un("raf",this),this[le]&&(globalThis.clearInterval(this[le]),this[le]=null),this.active=!1,this}},Vi=class{constructor(){var t=this;this.id=Symbol(),this.queue=[],this.stage=-1,this[Lt]=-1,this[Ye]=0,this[xt]=!1,this.listeners={},this.intervals={},t.commit=function(){return t.add("commit"),t},this[Fn]=0,t.$promise=null,t.$resolve=null,this[Ri]=function(e){return t[xt]=!1,t.tick(e)}}add(t,e){return(e||this.queue.indexOf(t)==-1)&&this.queue.push(t),this[xt]||this[Mi](),this}get committing\u03A6(){return this.queue.indexOf("commit")>=0}listen(t,e){let i=this.listeners[t],s=!i;return i||(i=this.listeners[t]=new Set),i.add(e),t=="raf"&&s&&this.add("raf"),this}unlisten(t,e){var i;let s=this.listeners[t];return s&&s.delete(e),t=="raf"&&s&&s.size==0&&(i=this.listeners.raf,delete this.listeners.raf),this}on(t,e){return this.listen(t,e)}un(t,e){return this.unlisten(t,e)}get promise(){var t=this;return t.$promise||(t.$promise=new Promise(function(e){return t.$resolve=e}))}tick(t){var e=this;let i=this.queue,s=this[Ye]++;if(this.ts||(this.ts=t),this.dt=t-this.ts,this.ts=t,this.queue=[],this[Lt]=1,i.length)for(let n=0,o=On(i),l=o.length;n<l;n++){let a=o[n];typeof a=="string"&&this.listeners[a]?e.listeners[a].forEach(function(c){if(c.tick instanceof Function)return c.tick(e,a);if(c instanceof Function)return c(e,a)}):a instanceof Function?a(e.dt,e):a.tick&&a.tick(e.dt,e)}return this[Lt]=this[xt]?0:-1,e.$promise&&(e.$resolve(e),e.$promise=e.$resolve=null),e.listeners.raf&&e.add("raf"),e}[Mi](){return this[xt]||(this[xt]=!0,this[Lt]==-1&&(this[Lt]=0),Pn(this[Ri])),this}schedule(t,e){var i,s;return e||(e=t[i=this.id]||(t[i]={value:!0})),(e[s=this.id]||(e[s]=new Li({owner:this,target:t}))).update(e,!0)}unschedule(t,e={}){e||(e=t[this.id]);let i=e&&e[this.id];return i&&i.active&&i.deactivate(),this}},O=new Vi;function Vt(){return O.add("commit").promise}function kn(r,t){return globalThis.setTimeout(function(){r(),Vt()},t)}function In(r,t){return globalThis.setInterval(function(){r(),Vt()},t)}var Dn=globalThis.clearInterval,Mn=globalThis.clearTimeout,jt=globalThis.imba||(globalThis.imba={});jt.commit=Vt;jt.setTimeout=kn;jt.setInterval=In;jt.clearInterval=Dn;jt.clearTimeout=Mn;var zo=Symbol.for("#__initor__"),Ko=Symbol.for("#__inited__"),Qe=class{constructor(t){this.dom=t,this.string=""}contains(t){return this.dom.classList.contains(t)}add(t){return this.contains(t)?this:(this.string+=(this.string?" ":"")+t,this.dom.classList.add(t),this)}remove(t){if(!this.contains(t))return this;let e=new RegExp("(^|\\s)*"+t+"(\\s|$)*","g");return this.string=this.string.replace(e,""),this.dom.classList.remove(t),this}toggle(t,e){return e===void 0&&(e=!this.contains(t)),e?this.add(t):this.remove(t)}incr(t){let e=this.stacks||(this.stacks={}),i=e[t]||0;return i<1&&this.add(t),e[t]=Math.max(i,0)+1}decr(t){let e=this.stacks||(this.stacks={}),i=e[t]||0;return i==1&&this.remove(t),e[t]=Math.max(i,1)-1}valueOf(){return this.string}toString(){return this.string}sync(){return this.dom.flagSync$()}};function Ht(r,t){let e=Object.getOwnPropertyDescriptors(t);return delete e.constructor,Object.defineProperties(r,e),r}function Rn(r){let t;return r?(t=r.toIterable)?t.call(r):r:[]}var Xe=Symbol.for("#parent"),Ln=Symbol.for("#context"),ji=Symbol.for("#__init__"),Hi=Symbol.for("#insertChild"),Ze=Symbol.for("#appendChild"),ti=Symbol.for("#replaceChild"),Ai=Symbol.for("#removeChild"),et=Symbol.for("#insertInto"),qi=Symbol.for("#insertIntoDeopt"),At=Symbol.for("#removeFrom"),Gi=Symbol.for("#removeFromDeopt"),wt=Symbol.for("#replaceWith"),Ui=Symbol.for("#replaceWithDeopt"),ei=Symbol.for("#placeholderNode"),Vn=Symbol.for("#attachToParent"),jn=Symbol.for("#detachFromParent"),Hn=Symbol.for("#placeChild"),An=Symbol.for("#beforeReconcile"),qn=Symbol.for("#afterReconcile"),Gn=Symbol.for("#afterVisit"),Qo=Symbol.for("#__initor__"),Xo=Symbol.for("#__inited__"),Bi=Symbol.for("##parent"),Un=Symbol.for("##up"),zi=Symbol.for("##context"),ft=Symbol.for("#domNode"),ae=Symbol.for("##placeholderNode"),Ki=Symbol.for("#domDeopt"),Wi=Symbol.for("#src"),he=Symbol.for("#htmlNodeName"),Zo=Symbol.for("#ImbaElement"),tl=Symbol(),{Event:dt,UIEvent:el,MouseEvent:Ji,PointerEvent:il,KeyboardEvent:Yi,CustomEvent:ue,Node:ce,Comment:fe,Text:ii,Element:j,HTMLElement:de,HTMLHtmlElement:sl,HTMLSelectElement:rl,HTMLInputElement:nl,HTMLTextAreaElement:ol,HTMLButtonElement:ll,HTMLOptionElement:al,HTMLScriptElement:hl,SVGElement:Qi,DocumentFragment:ul,ShadowRoot:cl,Document:Bn,Window:fl,customElements:dl}=globalThis.window,Xi={};function Zi(r,t,e){if(!r)return e[t]=null;if(e[t]!==void 0)return e[t];let i=Object.getOwnPropertyDescriptor(r,t);return i!==void 0||r==Qi?e[t]=i||null:Zi(Reflect.getPrototypeOf(r),t,e)}var si={},ri={},zn={},ni={};var Kn={get(r,t){let e=r,i;for(;e&&i==null;)(e=e[Xe])&&(i=e[t]);return i},set(r,t,e){let i=r,s;for(;i&&s==null;){if(oe(i,t,j))return i[t]=e,!0;i=i[Xe]}return!0}},ts=class{get flags(){return this.documentElement.flags}};Ht(Bn.prototype,ts.prototype);var es=class{get[Xe](){return this[Bi]||this.parentNode||this[Un]}get[Ln](){return this[zi]||(this[zi]=new Proxy(this,Kn))}[ji](){return this}[Hi](t,e){return t[et](this,e)}[Ze](t){return t[et](this,null)}[ti](t,e){let i=this[Hi](t,e);return this[Ai](e),i}[Ai](t){return t[At](this)}[et](t,e=null){return e?t.insertBefore(this,e):t.appendChild(this),this}[qi](t,e){return e?t.insertBefore(this[ft]||this,e):t.appendChild(this[ft]||this),this}[At](t){return t.removeChild(this)}[Gi](t){return t.removeChild(this[ft]||this)}[wt](t,e){return e[ti](t,this)}[Ui](t,e){return e[ti](t,this[ft]||this)}get[ei](){return this[ae]||(this[ae]=globalThis.document.createComment("placeholder"))}set[ei](t){let e=this[ae];this[ae]=t,e&&e!=t&&e.parentNode&&e[wt](t)}[Vn](){let t=this[ft],e=t&&t.parentNode;return t&&e&&t!=this&&(this[ft]=null,this[et](e,t),t[At](e)),this}[jn](){(this[Ki]!=!0?(this[Ki]=!0,!0):!1)&&(this[wt]=this[Ui],this[At]=this[Gi],this[et]=this[qi]);let t=this[ei];return this.parentNode&&t!=this&&(t[et](this.parentNode,this),this[At](this.parentNode)),this[ft]=t,this}[Hn](t,e,i){let s=typeof t;if(s==="undefined"||t===null){if(i&&i instanceof fe)return i;let n=globalThis.document.createComment("");return i?i[wt](n,this):n[et](this,null)}if(t===i)return t;if(s!=="object"){let n,o=t;return e&128&&e&256,i?i instanceof ii?(i.textContent=o,i):(n=globalThis.document.createTextNode(o),i[wt](n,this),n):(this.appendChild(n=globalThis.document.createTextNode(o)),n)}else return i?i[wt](t,this):t[et](this,null)}};Ht(ce.prototype,es.prototype);var is=class{log(...t){return console.log(...t),this}emit(t,e,i={bubbles:!0,cancelable:!0}){e!=null&&(i.detail=e);let s=new ue(t,i),n=this.dispatchEvent(s);return s}slot$(t,e){return this}text$(t){return this.textContent=t,this}[An](){return this}[qn](){return this}[Gn](){this.render&&this.render()}get flags(){return this.$flags||(this.$flags=new Qe(this),this.flag$==j.prototype.flag$&&(this.flags$ext=this.className),this.flagDeopt$()),this.$flags}flag$(t){let e=this.flags$ns;this.className=e?e+(this.flags$ext=t):this.flags$ext=t}flagDeopt$(){var t=this;this.flag$=this.flagExt$,t.flagSelf$=function(e){return t.flagSync$(t.flags$own=e)}}flagExt$(t){return this.flagSync$(this.flags$ext=t)}flagSelf$(t){return this.flagDeopt$(),this.flagSelf$(t)}flagSync$(){return this.className=(this.flags$ns||"")+(this.flags$ext||"")+" "+(this.flags$own||"")+" "+(this.$flags||"")}set$(t,e){let i=oe(this,t,j);!i||!i.set?this.setAttribute(t,e):this[t]=e}get richValue(){return this.value}set richValue(t){this.value=t}};Ht(j.prototype,is.prototype);j.prototype.setns$=j.prototype.setAttributeNS;function u(r,t,e,i){let s=globalThis.document.createElement(r);return e&&(s.className=e),i!==null&&s.text$(i),t&&t[Ze]&&t[Ze](s),s}var ss=class{set$(t,e){var i;let s=Xi[i=this.nodeName]||(Xi[i]={}),n=Zi(this,t,s);!n||!n.set?this.setAttribute(t,e):this[t]=e}flag$(t){let e=this.flags$ns;this.setAttribute("class",e?e+(this.flags$ext=t):this.flags$ext=t)}flagSelf$(t){var e=this;return e.flag$=function(i){return e.flagSync$(e.flags$ext=i)},e.flagSelf$=function(i){return e.flagSync$(e.flags$own=i)},e.flagSelf$(t)}flagSync$(){return this.setAttribute("class",(this.flags$ns||"")+(this.flags$ext||"")+" "+(this.flags$own||"")+" "+(this.$flags||""))}};Ht(Qi.prototype,ss.prototype);var rs=class{set src(t){if((this[Wi]!=t?(this[Wi]=t,!0):!1)&&t){if(t.adoptNode)t.adoptNode(this);else if(t.content){for(let e=t.attributes,i=0,s=Object.keys(e),n=s.length,o,l;i<n;i++)o=s[i],l=e[o],this.setAttribute(o,l);this.innerHTML=t.content}}}};Ht(SVGSVGElement.prototype,rs.prototype);function oi(r){return globalThis.document.createComment(r)}function li(r){return globalThis.document.createTextNode(r)}var me=globalThis.navigator,Wn=me&&me.vendor||"",ns=me&&me.userAgent||"",Jn=Wn.indexOf("Apple")>-1||ns.indexOf("CriOS")>=0||ns.indexOf("FxiOS")>=0,pe=!Jn,os=new Map,ls=class extends de{connectedCallback(){return pe?this.parentNode.removeChild(this):this.parentNode.connectedCallback()}disconnectedCallback(){if(!pe)return this.parentNode.disconnectedCallback()}};window.customElements.define("i-hook",ls);function Yn(r,t){let e=os.get(t);if(!e){e={};let i=t.prototype,s=[i];for(;(i=i&&Object.getPrototypeOf(i))&&i.constructor!=r.constructor;)s.unshift(i);for(let n=0,o=Rn(s),l=o.length;n<l;n++){let a=o[n],c=Object.getOwnPropertyDescriptors(a);Object.assign(e,c)}os.set(t,e)}return e}function N(r,t,e,i,s){let n;typeof r!="string"&&r&&r.nodeName&&(r=r.nodeName);let o=ri[r]||r;if(si[r]){let l=si[r],a=l.prototype[he];if(a&&pe)n=globalThis.document.createElement(a,{is:r});else if(l.create$&&a){n=globalThis.document.createElement(a),n.setAttribute("is",o);let c=Yn(n,l);Object.defineProperties(n,c),n.__slots={},n.appendChild(globalThis.document.createElement("i-hook"))}else l.create$?(n=l.create$(n),n.__slots={}):console.warn("could not create tag "+r)}else n=globalThis.document.createElement(ri[r]||r);return n[Bi]=t,n[ji](),i!==null&&n.slot$("__").text$(i),(e||n.flags$ns)&&n.flag$(e||""),n}function q(r,t,e={}){zn[r]=ni[r]=t,t.nodeName=r;let i=r,s=t.prototype;r.indexOf("-")==-1&&(i=""+r+"-tag",ri[r]=i);let n=s._ns_;if(e.ns){let o=e.ns,l=o+" "+o+"_ ";n&&(l+=s.flags$ns,o+=" "+n),s._ns_=o,s.flags$ns=l}return s[he]&&!e.extends&&(e.extends=s[he]),e.extends?(s[he]=e.extends,si[r]=t,pe&&window.customElements.define(i,t,{extends:e.extends})):window.customElements.define(i,t),t}var Qn=globalThis.imba||(globalThis.imba={});Qn.document=globalThis.document;function ai(r){let t;return r?(t=r.toIterable)?t.call(r):r:[]}var as=Symbol.for("#__initor__"),hs=Symbol.for("#__inited__"),Xn=Symbol.for("#parent"),us=Symbol.for("#appendChild"),cs=Symbol.for("#removeChild"),z=Symbol.for("#insertInto"),ge=Symbol.for("#replaceWith"),fs=Symbol.for("#insertChild"),be=Symbol.for("#removeFrom"),ds=Symbol.for("#placeChild"),ms=Symbol.for("#__init__"),hi=Symbol.for("##up"),Zn=Symbol.for("#domFlags"),V=Symbol.for("#end"),to=Symbol.for("##parent"),ps=Symbol.for("#textContent"),_e=Symbol.for("#textNode"),gs=Symbol(),ui=class{constructor(){this.childNodes=[]}log(...t){}hasChildNodes(){return!1}},eo=0,ci=class extends ui{static[ms](){return this.prototype[as]=gs,this}constructor(t,e){super(...arguments);this[hi]=e,this.parentNode=null,this[Zn]=t,this.childNodes=[],this[V]=oi("slot"+eo++),e&&e[us](this),this[as]===gs&&this[hs]&&this[hs]()}get[Xn](){return this[to]||this.parentNode||this[hi]}set textContent(t){this[ps]=t}get textContent(){return this[ps]}hasChildNodes(){for(let t=0,e=ai(this.childNodes),i=e.length;t<i;t++){let s=e[t];if(s instanceof ui&&s.hasChildNodes())return!0;if(!(s instanceof fe)){if(s instanceof Node)return!0}}return!1}text$(t){return this[_e]?this[_e].textContent=t:this[_e]=this[ds](t),this[_e]}appendChild(t){return this.parentNode&&t[z](this.parentNode,this[V]),this.childNodes.push(t)}[us](t){return this.parentNode&&t[z](this.parentNode,this[V]),this.childNodes.push(t)}insertBefore(t,e){this.parentNode&&this.parentNode[fs](t,e);let i=this.childNodes.indexOf(e);return i>=0&&this.childNodes.splice(i,0,t),t}[cs](t){this.parentNode&&this.parentNode[cs](t);let e=this.childNodes.indexOf(t);e>=0&&this.childNodes.splice(e,1)}[z](t,e){let i=this.parentNode;if(this.parentNode!=t?(this.parentNode=t,!0):!1){this[V]&&(e=this[V][z](t,e));for(let s=0,n=ai(this.childNodes),o=n.length;s<o;s++)n[s][z](t,e)}return this}[ge](t,e){let i=t[z](e,this[V]);return this[be](e),i}[fs](t,e){if(this.parentNode&&this.insertBefore(t,e||this[V]),e){let i=this.childNodes.indexOf(e);i>=0&&this.childNodes.splice(i,0,t)}else this.childNodes.push(t);return t}[be](t){for(let e=0,i=ai(this.childNodes),s=i.length;e<s;e++)i[e][be](t);return this[V]&&this[V][be](t),this.parentNode=null,this}[ds](t,e,i){let s=this.parentNode,n=typeof t;if(n==="undefined"||t===null){if(i&&i instanceof fe)return i;let o=oi("");if(i){let l=this.childNodes.indexOf(i);return this.childNodes.splice(l,1,o),s&&i[ge](o,s),o}return this.childNodes.push(o),s&&o[z](s,this[V]),o}if(t===i)return t;if(n!=="object"){let o,l=t;if(i){if(i instanceof ii)return i.textContent=l,i;{o=li(l);let a=this.childNodes.indexOf(i);return this.childNodes.splice(a,1,o),s&&i[ge](o,s),o}}else return this.childNodes.push(o=li(l)),s&&o[z](s,this[V]),o}else if(i){let o=this.childNodes.indexOf(i);return this.childNodes.splice(o,1,t),s&&i[ge](t,s),t}else return this.childNodes.push(t),s&&t[z](s,this[V]),t}};ci[ms]();function ye(r,t){let e=new ci(r,null);return e[hi]=t,e}function io(r){let t;return r?(t=r.toIterable)?t.call(r):r:[]}var $t=Symbol.for("#__init__"),bs=Symbol.for("#__initor__"),_s=Symbol.for("#__inited__"),so=Symbol.for("#afterVisit"),ro=Symbol.for("#beforeReconcile"),fi=Symbol.for("#count"),Ct=Symbol.for("#autorender"),ys=Symbol(),no=new class{constructor(r=null){this[$t](r)}[$t](r=null){var t;this.items=r&&(t=r.items)!==void 0?t:[],this.current=r&&(t=r.current)!==void 0?t:null,this.lastQueued=r&&(t=r.lastQueued)!==void 0?t:null,this.tests=r&&(t=r.tests)!==void 0?t:0}flush(){let r=null;for(;r=this.items.shift();){if(!r.parentNode||r.hydrated\u03A6)continue;let t=this.current;this.current=r,r.__F|=1024,r.connectedCallback(),this.current=t}}queue(r){var t=this;let e=this.items.length,i=0,s=this.lastQueued;this.lastQueued=r;let n=ce.DOCUMENT_POSITION_PRECEDING,o=ce.DOCUMENT_POSITION_FOLLOWING;if(e){let l=this.items.indexOf(s),a=l,c=function(h,p){return t.tests++,h.compareDocumentPosition(p)};(l==-1||s.nodeName!=r.nodeName)&&(a=l=0);let f=t.items[a];for(;f&&c(f,r)&o;)f=t.items[++a];if(a!=l)f?t.items.splice(a,0,r):t.items.push(r);else{for(;f&&c(f,r)&n;)f=t.items[--a];a!=l&&(f?t.items.splice(a+1,0,r):t.items.unshift(r))}}else t.items.push(r),t.current||globalThis.queueMicrotask(t.flush.bind(t))}run(r){var t,e;if(this.active)return;this.active=!0;let i=globalThis.document.querySelectorAll(".__ssr");console.log("running hydrator",r,i.length,Array.from(i));for(let s=0,n=io(i),o=n.length;s<o;s++){let l=n[s];l[fi]||(l[fi]=1),l[fi]++;let a=l.nodeName,c=(e=this.map)[a]||(e[a]=globalThis.window.customElements.get(a.toLowerCase())||de);console.log("item type",a,c,!!ni[a.toLowerCase()]),!(!l.connectedCallback||!l.parentNode||l.hydrated\u03A6)&&console.log("hydrate",l)}return this.active=!1}};var F=class extends de{static[$t](){return this.prototype[bs]=ys,this}constructor(){super();this.flags$ns&&(this.flag$=this.flagExt$),this.setup$(),this.build(),this[bs]===ys&&this[_s]&&this[_s]()}setup$(){return this.__slots={},this.__F=0}[$t](){return this.__F|=1|2,this}flag$(t){this.className=this.flags$ext=t}slot$(t,e){var i;return t=="__"&&!this.render?this:(i=this.__slots)[t]||(i[t]=ye(0,this))}build(){return this}awaken(){return this}mount(){return this}unmount(){return this}rendered(){return this}dehydrate(){return this}hydrate(){return this.autoschedule=!0,this}tick(){return this.commit()}visit(){return this.commit()}commit(){return this.render\u03A6?(this.__F|=256,this.render&&this.render(),this.rendered(),this.__F=(this.__F|512)&~256&~8192):(this.__F|=8192,this)}get autoschedule(){return(this.__F&64)!=0}set autoschedule(t){t?this.__F|=64:this.__F&=~64}set autorender(t){let e=this[Ct]||(this[Ct]={});e.value=t,this.mounted\u03A6&&O.schedule(this,e)}get render\u03A6(){return!this.suspended\u03A6}get mounting\u03A6(){return(this.__F&16)!=0}get mounted\u03A6(){return(this.__F&32)!=0}get awakened\u03A6(){return(this.__F&8)!=0}get rendered\u03A6(){return(this.__F&512)!=0}get suspended\u03A6(){return(this.__F&4096)!=0}get rendering\u03A6(){return(this.__F&256)!=0}get scheduled\u03A6(){return(this.__F&128)!=0}get hydrated\u03A6(){return(this.__F&2)!=0}get ssr\u03A6(){return(this.__F&1024)!=0}schedule(){return O.on("commit",this),this.__F|=128,this}unschedule(){return O.un("commit",this),this.__F&=~128,this}async suspend(t=null){let e=this.flags.incr("_suspended_");return this.__F|=4096,t instanceof Function&&(await t(),this.unsuspend()),this}unsuspend(){return this.flags.decr("_suspended_")==0&&(this.__F&=~4096,this.commit()),this}[so](){return this.visit()}[ro](){return this.__F&1024&&(this.__F=this.__F&~1024,this.classList.remove("_ssr_"),this.flags$ext&&this.flags$ext.indexOf("_ssr_")==0&&(this.flags$ext=this.flags$ext.slice(5)),this.__F&512||(this.innerHTML="")),this}connectedCallback(){let t=this.__F,e=t&1,i=t&8;if(!e&&!(t&1024)){no.queue(this);return}if(t&(16|32))return;this.__F|=16,e||this[$t](),t&2||(this.flags$ext=this.className,this.__F|=2,this.hydrate(),this.commit()),i||(this.awaken(),this.__F|=8);let s=this.mount();return s&&s.then instanceof Function&&s.then(O.commit),t=this.__F=(this.__F|32)&~16,t&64&&this.schedule(),this[Ct]&&O.schedule(this,this[Ct]),this}disconnectedCallback(){if(this.__F=this.__F&(~32&~16),this.__F&128&&this.unschedule(),this.unmount(),this[Ct])return O.unschedule(this,this[Ct])}};F[$t]();var P={context:null};var oo=Symbol.for("#insertInto"),Ss=Symbol.for("#removeFrom");function di(r,t){let e=t||globalThis.document.body,i=r;if(r instanceof Function){let s={_:e},n=function(){let o=P.context;P.context=s;let l=r(s);return P.context==s&&(P.context=o),l};i=n(),O.listen("commit",n)}else i.__F|=64;return i[oo](e),i}function lo(r){return r&&r[Ss]&&r[Ss](r.parentNode),r}var vs=globalThis.imba||(globalThis.imba={});vs.mount=di;vs.unmount=lo;function xs(r){let t;return r?(t=r.toIterable)?t.call(r):r:[]}var ao=Symbol.for("#container"),ho=Symbol.for("#afterVisit"),mt=Symbol.for("#__init__"),ws=Symbol.for("#__initor__"),$s=Symbol.for("#__inited__"),Se=Symbol.for("#listeners"),G=Symbol.for("#slot"),uo=Symbol.for("#parent"),M=Symbol.for("##container"),mi=Symbol.for("#domTarget"),Cs=Symbol.for("#insertInto"),co=Symbol.for("#removeFrom"),fo=Symbol.for("#self"),mo=Symbol.for("#target"),Ts=Symbol(),ve=class extends F{static[mt](){return this.prototype[ws]=Ts,this}constructor(){super(...arguments);super[mt]||this[mt](),this[ws]===Ts&&this[$s]&&this[$s]()}[mt](t=null){super[mt]&&super[mt](...arguments),this.to=t?t.to:void 0}build(){return this[Se]=[],this.win=globalThis,this.doc=globalThis.document}setup(){return this.setAttribute("style","display:none !important;")}slot$(t,e){return this[G]||(this[G]=ye(0,this[uo])),this[G]}get[ao](){if(!this[M]){let t=this.className;this[M]=this.doc.createElement("div"),this[M].className=t,this[M].style.cssText="display:contents !important;"}return this[M]}get domTarget(){return this[mi]||(this[mi]=this.to instanceof j?this.to:this.closest(this.to)||this.doc.querySelector(this.to))}get eventTarget(){return this.domTarget}get style(){return this[M]?this[M].style:super.style}get classList(){return this[M]?this[M].classList:super.classList}get className(){return this[M]?this[M].className:super.className}set className(t){this[M]?this[M].className=t:super.className=t}[ho](){if(this.mounted\u03A6&&this[G]&&!this[G].parentNode)return this[G][Cs](this.target)}mount(){for(let e=0,i=xs(this[Se]),s=i.length;e<s;e++){let[n,o,l]=i[e];this.eventTarget.addEventListener(n,o,l)}let t=this.domTarget;return this[G]&&this[G][Cs](t),this}unmount(){for(let t=0,e=xs(this[Se]),i=e.length;t<i;t++){let[s,n,o]=e[t];this.eventTarget.removeEventListener(s,n,o)}return this[G]&&this[G][co](this.domTarget),this[mi]=null,this}addEventListener(t,e,i={}){var s;if(e[fo]=this,this[Se].push([t,e,i]),this.mounted\u03A6&&((s=this.eventTarget)==null?void 0:s.addEventListener))return this.eventTarget.addEventListener(t,e,i)}};ve[mt]();var Ns=class extends ve{get domTarget(){return this.doc.body}get eventTarget(){return this.win}addEventListener(t,e,i={}){return e[mo]=this.domTarget.parentNode,super.addEventListener(...arguments)}on$resize(t,e,i,s){return this.addEventListener("resize",i,s),i}};globalThis.customElements&&(globalThis.customElements.define("i-teleport",ve),globalThis.customElements.define("i-global",Ns));function xe(){return!0}function po(r,t){let e=Object.getOwnPropertyDescriptors(t);return delete e.constructor,Object.defineProperties(r,e),r}function we(){return!0}var Es=class{\u03B1esc(){return this.keyCode==27}\u03B1tab(){return this.keyCode==9}\u03B1enter(){return this.keyCode==13}\u03B1space(){return this.keyCode==32}\u03B1up(){return this.keyCode==38}\u03B1down(){return this.keyCode==40}\u03B1left(){return this.keyCode==37}\u03B1right(){return this.keyCode==39}\u03B1del(){return this.keyCode==8||this.keyCode==46}\u03B1key(t){if(typeof t=="string")return this.key==t;if(typeof t=="number")return this.keyCode==t}};po(Yi.prototype,Es.prototype);function go(r,t){let e=Object.getOwnPropertyDescriptors(t);return delete e.constructor,Object.defineProperties(r,e),r}function Tt(){return!0}var Os=class{\u03B1left(){return this.button==0}\u03B1middle(){return this.button==1}\u03B1right(){return this.button==2}\u03B1shift(){return!!this.shiftKey}\u03B1alt(){return!!this.altKey}\u03B1ctrl(){return!!this.ctrlKey}\u03B1meta(){return!!this.metaKey}};go(Ji.prototype,Os.prototype);function pi(r,t){let e=Object.getOwnPropertyDescriptors(t);return delete e.constructor,Object.defineProperties(r,e),r}function Fs(r){let t;return r?(t=r.toIterable)?t.call(r):r:[]}var bo=Symbol.for("#extendType"),_o=Symbol.for("#modifierState"),$e=Symbol.for("#sharedModifierState"),Ps=Symbol.for("#onceHandlerEnd"),ql=Symbol.for("#__initor__"),Gl=Symbol.for("#__inited__"),ks=Symbol.for("#extendDescriptors"),R=Symbol.for("#context"),Is=Symbol.for("#self"),yo=Symbol.for("#target"),Ds=Symbol.for("#stopPropagation"),Ms=Symbol.for("#defaultPrevented");we();Tt();var Rs=class{[bo](t){var e,i,s;let n=t[ks]||(t[ks]=(i=Object.getOwnPropertyDescriptors(t.prototype),s=i.constructor,delete i.constructor,i));return Object.defineProperties(this,n)}};pi(ue.prototype,Rs.prototype);var Ls=class{get[_o](){var t,e;return(t=this[R])[e=this[R].step]||(t[e]={})}get[$e](){var t,e;return(t=this[R].handler)[e=this[R].step]||(t[e]={})}[Ps](t){return Rt(this[R],"end",t)}\u03B1sel(t){return!!this.target.matches(String(t))}\u03B1log(...t){return console.info(...t),!0}\u03B1trusted(){return!!this.isTrusted}\u03B1if(t){return!!t}\u03B1wait(t=250){return new Promise(function(e){return setTimeout(e,Mt(t))})}\u03B1self(){return this.target==this[R].element}\u03B1cooldown(t=250){let e=this[$e];return e.active?!1:(e.active=!0,e.target=this[R].element,e.target.flags.incr("cooldown"),this[Ps](function(){return setTimeout(function(){return e.target.flags.decr("cooldown"),e.active=!1},Mt(t))}),!0)}\u03B1throttle(t=250){var e=this;let i=this[$e];return i.active?(i.next&&i.next(!1),new Promise(function(s){return i.next=function(n){return i.next=null,s(n)}})):(i.active=!0,i.el||(i.el=this[R].element),i.el.flags.incr("throttled"),Rt(this[R],"end",function(){let s,n=Mt(t);return s=setInterval(function(){i.next?i.next(!0):(clearInterval(e.iv),i.el.flags.decr("throttled"),i.active=!1)},n)}),!0)}\u03B1debounce(t=250){let e=this[$e],i=this;return e.queue||(e.queue=[]),e.queue.push(e.last=i),new Promise(function(s){return setTimeout(function(){return e.last==i?(i.debounced=e.queue,e.last=null,e.queue=[],s(!0)):s(!1)},Mt(t))})}\u03B1flag(t,e){let{element:i,step:s,state:n,id:o,current:l}=this[R],a=e instanceof j?e:e?i.closest(e):i;if(!a)return!0;this[R].commit=!0,n[s]=o,a.flags.incr(t);let c=Date.now();return Rt(l,"end",function(){let f=Date.now()-c,h=Math.max(250-f,0);return setTimeout(function(){return a.flags.decr(t)},h)}),!0}\u03B1busy(t){return this.\u03B1flag("busy",t)}\u03B1mod(t){return this.\u03B1flag("mod-"+t,globalThis.document.documentElement)}\u03B1outside(){let{handler:t}=this[R];if(t&&t[Is])return!t[Is].parentNode.contains(this.target)}};pi(dt.prototype,Ls.prototype);function Nt(){return!0}var Vs=class{constructor(t,e){this.params=t,this.closure=e}getHandlerForMethod(t,e){return t?t[e]?t:this.getHandlerForMethod(t.parentNode,e):null}emit(t,...e){return Je(this,t,e)}on(t,...e){return We(this,t,...e)}once(t,...e){return Rt(this,t,...e)}un(t,...e){return Ii(this,t,...e)}get passive\u03A6(){return this.params.passive}get capture\u03A6(){return this.params.capture}get silent\u03A6(){return this.params.silent}get global\u03A6(){return this.params.global}async handleEvent(t){let e=this[yo]||t.currentTarget,i=this.params,s=null,n=i.silence||i.silent;this.count||(this.count=0),this.state||(this.state={});let o={element:e,event:t,modifiers:i,handler:this,id:++this.count,step:-1,state:this.state,commit:null,current:null};if(o.current=o,t.handle$mod&&t.handle$mod.apply(o,i.options||[])==!1)return;let l=dt[this.type+"$handle"]||dt[t.type+"$handle"]||t.handle$mod;if(!(l&&l.apply(o,i.options||[])==!1)){this.currentEvents||(this.currentEvents=new Set),this.currentEvents.add(t);for(let a=0,c=Object.keys(i),f=c.length,h,p;a<f;a++){if(h=c[a],p=i[h],o.step++,h[0]=="_")continue;h.indexOf("~")>0&&(h=h.split("~")[0]);let g=null,d=[t,o],m,T=null,it,st=!1,Et=typeof h=="string";if(h[0]=="$"&&h[1]=="_"&&p[0]instanceof Function)h=p[0],h.passive||(o.commit=!0),d=[t,o].concat(p.slice(1)),T=e;else if(p instanceof Array){d=p.slice(),g=d;for(let I=0,b=Fs(d),U=b.length;I<U;I++){let H=b[I];if(typeof H=="string"&&H[0]=="~"&&H[1]=="$"){let rt=H.slice(2).split("."),bt=o[rt.shift()]||t;for(let L=0,nt=Fs(rt),_t=nt.length;L<_t;L++){let Ot=nt[L];bt=bt?bt[Ot]:void 0}d[I]=bt}}}if(typeof h=="string"&&(it=h.match(/^(emit|flag|mod|moved|pin|fit|refit|map|remap|css)-(.+)$/))&&(g||(g=d=[]),d.unshift(it[2]),h=it[1]),h=="trap")t[Ds]=!0,t.stopImmediatePropagation(),t[Ms]=!0,t.preventDefault();else if(h=="stop")t[Ds]=!0,t.stopImmediatePropagation();else if(h=="prevent")t[Ms]=!0,t.preventDefault();else if(h=="commit")o.commit=!0;else if(h=="once")e.removeEventListener(t.type,this);else{if(h=="options"||h=="silence"||h=="silent")continue;if(h=="emit"){let I=d[0],b=d[1],U=new ue(I,{bubbles:!0,detail:b});U.originalEvent=t;let H=e.dispatchEvent(U)}else if(typeof h=="string"){h[0]=="!"&&(st=!0,h=h.slice(1));let I="\u03B1"+h,b=t[I];b||(b=this.type&&dt[this.type+"$"+h+"$mod"]),b||(b=t[h+"$mod"]||dt[t.type+"$"+h]||dt[h+"$mod"]),b instanceof Function?(h=b,T=o,d=g||[],t[I]&&(T=t,t[R]=o)):h[0]=="_"?(h=h.slice(1),T=this.closure):T=this.getHandlerForMethod(e,h)}}try{h instanceof Function?m=h.apply(T||e,d):T&&(m=T[h].apply(T,d)),m&&m.then instanceof Function&&m!=O.$promise&&(o.commit&&!n&&O.commit(),m=await m)}catch(I){s=I;break}if(st&&m===!0||!st&&m===!1)break;o.value=m}if(Je(o,"end",o),o.commit&&!n&&O.commit(),this.currentEvents.delete(t),this.currentEvents.size==0&&this.emit("idle"),s)throw s}}},js=class{on$(t,e,i){let s="on$"+t,n;n=new Vs(e,i);let o=e.capture||!1,l=e.passive,a=o;return l&&(a={passive:l,capture:o}),this[s]instanceof Function?n=this[s](e,i,n,a):this.addEventListener(t,n,a),n}};pi(j.prototype,js.prototype);var Hs=Symbol.for("#__init__"),So=Symbol.for("#beforeReconcile"),As=Symbol.for("##up"),qs=Symbol.for("#appendChild"),vo=Symbol.for("#afterReconcile"),Gs=Symbol(),Us=Symbol(),Bs=Symbol(),zs=Symbol(),Ks=Symbol();Nt();var Ws=class extends F{get $preview(){return this[Us]||(this[Us]=u("img",null,`cu-ai preview ${this._ns_||""} ref--preview`,null))}get $origin(){return this[zs]||(this[zs]=u("img",null,`cu-aj origin ${this._ns_||""} ref--origin`,null))}[Hs](t=null){super[Hs](...arguments),this.useImageCallback=t?t.useImageCallback:void 0,this.image=t?t.image:void 0}useImage(t){var e=this;let i=t.target.files[0],s=URL.createObjectURL(i);return this.$origin.src=s,e.$origin.onload=function(){return e.useImageCallback(e.$origin,i),Vt()}}rendered(){return this.image&&this.image.src?this.$preview.src=this.image.src:this.$preview.src=""}render(){var t=this,e,i,s,n=this._ns_||"",o,l,a;return e=this,e[So](),i=s=1,e[Gs]===1||(i=s=0,e[Gs]=1),(!i||s&2)&&e.flagSelf$("cu-ag dropbox"),i||(o=u("input",e,`cu-ah input ${n}`,null)),i||(o.type="file"),i||o.on$("change",{$_:[function(c,f){return t.useImage(c)}]},this),(l=e[Bs])||(e[Bs]=(l=this.$preview,l[As]=e,l)),i||e[qs](l),(a=e[Ks])||(e[Ks]=(a=this.$origin,a[As]=e,a)),i||e[qs](a),e[vo](s),e}};q("image-dropbox",Ws,{ns:"cu_af"});var Js=Symbol.for("#__init__"),xo=Symbol.for("#beforeReconcile"),wo=Symbol.for("#afterVisit"),Ys=Symbol.for("#appendChild"),$o=Symbol.for("##up"),Co=Symbol.for("#afterReconcile"),Qs=Symbol(),Xs=Symbol(),Zs=Symbol(),tr=Symbol(),er=Symbol(),ir=Symbol(),sr=Symbol();Nt(),we(),Tt(),xe();var rr=class extends F{get $canvas(){return this[Zs]||(this[Zs]=u("canvas",null,`dc-ah ${this._ns_||""} canvas ref--canvas`,null))}[Js](t=null){var e;super[Js](...arguments),this.left=t?t.left:void 0,this.right=t?t.right:void 0,this.xOffset=t?t.xOffset:void 0,this.yOffset=t?t.yOffset:void 0,this.alignmentState=t?t.alignmentState:void 0,this.dragging=t&&(e=t.dragging)!==void 0?e:!1,this.startingPoint=t?t.startingPoint:void 0,this.startingOffset=t?t.startingOffset:void 0}draw(t,e,i,s){this.$canvas.width=t.width,this.$canvas.height=t.height;let n=this.$canvas.getContext("2d");return n.globalAlpha=.5,n.drawImage(t,0,0,t.width,t.height,0,0,t.width,t.height),n.drawImage(e,0,0,e.width,e.height,i,s,e.width,e.height)}rendered(){return this.alignmentState.left&&this.alignmentState.right?this.draw(this.alignmentState.left,this.alignmentState.right,this.alignmentState.xOffset,this.alignmentState.yOffset):this.$canvas.height=0}keydown(t){switch(t.key){case"ArrowUp":{return t.preventDefault(),this.alignmentState.yOffset-=1;break}case"ArrowDown":{return t.preventDefault(),this.alignmentState.yOffset+=1;break}case"ArrowLeft":{return t.preventDefault(),this.alignmentState.xOffset-=1;break}case"ArrowRight":{return t.preventDefault(),this.alignmentState.xOffset+=1;break}}}mousedown(t){if(t.which==1)return this.dragging=!0,this.startingPoint={x:t.screenX,y:t.screenY},this.startingOffset={x:this.alignmentState.xOffset,y:this.alignmentState.yOffset}}mouseup(){return this.dragging=!1}mousemove(t){if(this.dragging)return this.ratio=this.$canvas.width/this.$canvas.clientWidth,this.alignmentState.xOffset=this.startingOffset.x+Math.round((t.screenX-this.startingPoint.x)*this.ratio),this.alignmentState.yOffset=this.startingOffset.y+Math.round((t.screenY-this.startingPoint.y)*this.ratio)}render(){var t=this,e,i,s,n=this._ns_||"",o,l,a,c,f,h,p;return e=this,e[xo](),i=s=1,e[Qs]===1||(i=s=0,e[Qs]=1),(!i||s&2)&&e.flagSelf$("dc-af"),l=a=1,(o=e[Xs])||(l=a=0,e[Xs]=o=N("i-global",e,`dc-ag ${n}`,null)),l||o.on$("keydown",{$_:[function(g,d){return t.keydown(g)}]},this),l||!o.setup||o.setup(a),o[wo](a),l||e[Ys](o),f=h=1,(c=e[tr])||(f=h=0,e[tr]=(c=this.$canvas,c[$o]=e,c)),f||(c.height=0),p=e[er]||(e[er]={$_:[function(g,d,m){return m.mousedown(g)},null]}),p.$_[1]=t,f||c.on$("mousedown",p,this),p=e[ir]||(e[ir]={$_:[function(g,d,m){return m.mousemove(g)},null]}),p.$_[1]=t,f||c.on$("mousemove",p,this),p=e[sr]||(e[sr]={$_:[function(g,d,m){return m.mouseup(g)},null]}),p.$_[1]=t,f||c.on$("mouseup",p,this),f||e[Ys](c),e[Co](s),e}};q("adjustment-canvas",rr,{});function gi(r,t,e,i){let s={x:0,y:0,w:0,h:0},n={x:0,y:0,w:0,h:0};return e>0?(s.x=e,s.w=r.width-e,n.x=0,n.w=s.w):(s.x=0,s.w=t.width+e,n.x=-e,n.w=s.w),i>0?(s.y=i,s.h=r.height-i,n.y=0,n.h=s.h):(s.y=0,s.h=t.height+i,n.y=-i,n.h=s.h),[s,n]}var nr=Symbol.for("#__init__"),To=Symbol.for("#beforeReconcile"),bi=Symbol.for("##up"),_i=Symbol.for("#appendChild"),No=Symbol.for("#afterReconcile"),or=Symbol(),lr=Symbol(),ar=Symbol(),hr=Symbol(),ur=Symbol(),cr=Symbol(),fr=Symbol(),dr=class extends F{get $container(){return this[lr]||(this[lr]=u("div",null,`cz-ag ${this._ns_||""} container ref--container`,null))}get $widthHolder(){return this[hr]||(this[hr]=u("div",null,`cz-ai ${this._ns_||""} widthHolder ref--widthHolder`,null))}get $preview(){return this[cr]||(this[cr]=u("canvas",null,`cz-aj ${this._ns_||""} preview ref--preview`,null))}[nr](t=null){super[nr](...arguments),this.alignmentState=t?t.alignmentState:void 0}drawPreview(t,e,i,s,n){let o=t.getContext("2d"),[l,a]=gi(e,i,s,n);return t.width=l.w*2,t.height=l.h,o.drawImage(e,l.x,l.y,l.w,l.h,0,0,l.w,l.h),o.drawImage(i,a.x,a.y,a.w,a.h,l.w,0,l.w,l.h)}calculateHeight(t,e){return Math.max(t.height,e.height)*(this.$widthHolder.clientWidth/(t.width+e.width))}calculateCanvasWidth(t,e,i){let s=i.width/i.height,n=e*s;return Math.min(t,n)}rendered(){if(this.alignmentState.left&&this.alignmentState.right){this.drawPreview(this.$preview,this.alignmentState.left,this.alignmentState.right,this.alignmentState.xOffset,this.alignmentState.yOffset);let t=300;return this.$container.style.maxHeight=t,this.$preview.style.width=this.calculateCanvasWidth(this.$widthHolder.clientWidth,t,this.$preview)}else return this.$preview.height=0}render(){var t,e,i,s,n,o,l,a;return t=this,t[To](),e=i=1,t[or]===1||(e=i=0,t[or]=1),(!e||i&2)&&t.flagSelf$("cz-af"),(s=t[ar])||(t[ar]=(s=this.$container,s[bi]=t,s)),(n=t[ur])||(t[ur]=(n=this.$widthHolder,n[bi]=s,n)),e||s[_i](n),l=a=1,(o=t[fr])||(l=a=0,t[fr]=(o=this.$preview,o[bi]=s,o)),l||(o.id="preview"),l||(o.height=0),l||s[_i](o),e||t[_i](s),t[No](i),t}};q("preview-canvas",dr,{});var mr=Symbol.for("#__init__"),Eo=Symbol.for("#beforeReconcile"),pr=Symbol.for("#placeChild"),Oo=Symbol.for("#afterReconcile"),gr=Symbol(),br=Symbol(),_r=Symbol(),yr=Symbol(),Sr=Symbol(),vr=Symbol(),xr=class extends F{[mr](t=null){var e;super[mr](...arguments),this.title=t&&(e=t.title)!==void 0?e:"Untitled"}render(){var t,e,i,s=this._ns_||"",n,o,l,a;return t=this,t[Eo](),e=i=1,t[gr]===1||(e=i=0,t[gr]=1),(!e||i&2)&&t.flagSelf$("dd-ag box"),(n=t[br])||(t[br]=n=u("div",t,`dd-ah title ${s}`,null)),o=this.title,o===t[yr]&&e||(t[_r]=n[pr](t[yr]=o,384,t[_r])),(l=t[Sr])||(t[Sr]=l=u("div",t,`dd-ai ${s}`,null)),a=t.__slots.__,t[vr]=l[pr](a,384,t[vr]),t[Oo](i),t}};q("title-box",xr,{ns:"dd_af"});function Ce(r){let t=r.length,e=r.sort(),i=Math.ceil(t/2);return t%2==0?(e[i]+e[i-1])/2:e[i-1]}function Fo(r,t,e,i,s,n){let o=new cv.Mat,l=new cv.Scalar(0,255,0,255);cv.drawMatches(r,t,e,i,s,o,l),cv.imshow(n,o)}function Po(r,t){let e=new cv.DMatchVector,i=0;for(let s=0;s<r.size();++s){let n=r.get(s),o=n.get(0),l=n.get(1);o.distance/l.distance<t&&(e.push_back(o),i++)}return console.log(t),console.log("keeping ",i," points in good_matches vector out of ",r.size()," contained in this match vector:",r),e}function ko(r,t,e){let i=[],s=[];for(let n=0;n<r.size();n++)i.push(t.get(r.get(n).queryIdx).pt),s.push(e.get(r.get(n).trainIdx).pt);return[i,s]}function Io(r,t){let e=[],i=[],s=r.map((n,o)=>{let l=t[o];e.push(n.x-l.x),i.push(n.y-l.y)});return[e,i]}function Do(r,t){let e=new cv.Mat,i=new cv.Mat;cv.cvtColor(r,e,cv.COLOR_BGR2GRAY),cv.cvtColor(t,i,cv.COLOR_BGR2GRAY);let s=new cv.KeyPointVector,n=new cv.KeyPointVector,o=new cv.Mat,l=new cv.Mat,a=new cv.ORB;a.detectAndCompute(e,new cv.Mat,s,o),a.detectAndCompute(i,new cv.Mat,n,l),console.log("features detected");let c=new cv.BFMatcher,f=new cv.DMatchVectorVector;return c.knnMatch(o,l,f,2),console.log("knn matched"),{leftKeyPoints:s,rightKeyPoints:n,matches:f}}function yi(r,t,e){let i=cv.imread(r),s=cv.imread(t);console.log("images loaded");let{leftKeyPoints:n,rightKeyPoints:o,matches:l}=Do(i,s);console.log("feature matched");let a=Po(l,e);Fo(i,n,s,o,a,"matches");let[c,f]=ko(a,n,o),[h,p]=Io(c,f);return console.log("median xd: "+Ce(h)),console.log("median yd: "+Ce(p)),[Math.round(Ce(h)),Math.round(Ce(p))]}var wr=Symbol.for("#__init__"),pt=Symbol.for("##up"),qt=Symbol.for("#placeChild"),Mo=Symbol.for("#beforeReconcile"),E=Symbol.for("#appendChild"),k=Symbol.for("#afterVisit"),Ro=Symbol.for("#afterReconcile"),$r=Symbol(),Cr=Symbol(),Tr=Symbol(),Nr=Symbol(),Er=Symbol(),Or=Symbol(),Fr=Symbol(),Pr=Symbol(),kr=Symbol(),Ir=Symbol(),Dr=Symbol(),Mr=Symbol(),Rr=Symbol(),Lr=Symbol(),Vr=Symbol(),jr=Symbol(),Hr=Symbol(),Ar=Symbol(),qr=Symbol(),ya=Symbol(),Gr=Symbol(),Ur=Symbol(),Sa=Symbol(),Br=Symbol(),zr=Symbol(),Kr=Symbol(),Wr=Symbol(),Jr=Symbol(),Yr=Symbol(),Qr=Symbol(),Xr=Symbol(),Zr=Symbol(),tn=Symbol(),en=Symbol(),sn=Symbol(),rn=Symbol(),nn=Symbol(),on=Symbol(),ln=Symbol(),an=Symbol(),hn=Symbol(),un=Symbol(),cn=Symbol(),fn=Symbol(),dn=Symbol(),mn=Symbol(),pn=Symbol(),gn=Symbol(),bn=Symbol(),_n=Symbol(),yn=Symbol(),Sn=Symbol(),vn=Symbol(),xn=Symbol(),gt,Si=P.context||{},wn=Symbol(),Te,Ne;Nt(),Tt(),xe();var $n=class extends F{get $forSave(){return this[Vr]||(this[Vr]=u("canvas",null,`cf-an ${this._ns_||""} forSave ref--forSave`,null))}get $logs(){return this[cn]||(this[cn]=u("div",null,`cf-bs ${this._ns_||""} logs ref--logs`,null))}[wr](t=null){var e;super[wr](...arguments),this.state=t&&(e=t.state)!==void 0?e:{left:null,right:null,leftName:"",rightName:"",xOffset:0,yOffset:0},this.currentTab=t&&(e=t.currentTab)!==void 0?e:"adjustment"}processAlign(){if(this.state.left&&this.state.right)try{this.log("User: Automatic align");let[t,e]=yi(this.state.left,this.state.right,.7);return console.log(t,e),this.state.xOffset=t,this.state.yOffset=e}catch(t){return window.alert(t)}}metadata(t){return`{
  "left": "`+t.leftName+`",
  "right": "`+t.rightName+`",
  "xOffset": `+t.xOffset+`,
  "yOffset": `+t.yOffset+`
}`}reset(){return this.state.left=null,this.state.right=null,this.state.leftName="",this.state.rightName="",this.state.xOffset=0,this.state.yOffset=0,this.log("User: Dropbox reset")}swap(){return[this.state.left,this.state.right]=[this.state.right,this.state.left],[this.state.leftName,this.state.rightName]=[this.state.rightName,this.state.leftName],this.state.xOffset=-this.state.xOffset,this.state.yOffset=-this.state.yOffset,this.log("User: Left-right swap")}viewStatus(){return this.state.xOffset>=0?"ParallelView":"CrossView"}log(t){var e=this._ns_||"",i,s=P.context||{},n,o,l;return this.$logs.appendChild((()=>(n=o=1,(i=s[$r])||(n=o=0,s[$r]=i=u("div",null,`cf-af ${e}`,null)),n||(i[pt]=s._),l=t,l===i[Tr]&&n||(i[Cr]=i[qt](i[Tr]=l,384,i[Cr])),i))()),this.$logs.scrollTo(0,1e5)}downloadJPEG(){var t=this._ns_||"",e,i=P.context||{},s,n,o;let l=globalThis.document.querySelector("canvas#preview");return(s=n=1,(e=i[Nr])||(s=n=0,i[Nr]=e=u("a",null,`cf-ag ${t}`,null)),s||(e[pt]=i._),o=l.toDataURL("image/jpeg"),o===e[Er]||(e.href=e[Er]=o),o=""+this.state.leftName+"_"+this.state.rightName+".jpg",o===e[Or]||(e.download=e[Or]=o),e).click()}downloadSeparateJPEG(){var t=this._ns_||"",e,i=P.context||{},s,n,o,l,a,c,f;let h=globalThis.document.querySelector("canvas#preview"),p=this.$forSave.getContext("2d"),g=h.width/2,d=h.height;this.$forSave.width=g,this.$forSave.height=d,p.drawImage(h,0,0,g,d,0,0,g,d);let m=this.$forSave.toDataURL("image/jpeg");p.drawImage(h,g,0,g,d,0,0,g,d);let T=this.$forSave.toDataURL("image/jpeg");return(s=n=1,(e=i[Fr])||(s=n=0,i[Fr]=e=u("a",null,`cf-ah ${t}`,null)),s||(e[pt]=i._),m===e[Pr]||(e.href=e[Pr]=m),o=""+this.state.leftName+"_"+this.state.rightName+"_left.jpg",o===e[kr]||(e.download=e[kr]=o),e).click(),(a=c=1,(l=i[Ir])||(a=c=0,i[Ir]=l=u("a",null,`cf-ai ${t}`,null)),a||(l[pt]=i._),T===l[Dr]||(l.href=l[Dr]=T),f=""+this.state.leftName+"_"+this.state.rightName+"_right.jpg",f===l[Mr]||(l.download=l[Mr]=f),l).click()}render(){var t=this,e,i,s,n=this._ns_||"",o,l,a,c,f,h,p,g,d,m,T,it,st,Et,I,b,U,H,Gt,rt,bt,L,nt,_t,Ot,vi,Ee,Oe,xi,Fe,K,ot,Ut,wi,Bt,Pe,ke,$i,Ie,Cn,Ft,lt,Ci,De,Tn,yt,Me,W,A,zt,Ti,Ni,Kt,Nn,Pt,J,kt,Wt,Re,at,Jt,Yt,Le,Y,It,Qt,Ve,ht,Xt,Zt,je,ut,Q,St,te,He,Dt,X,vt,ee,Ei,ie,Ae,Z,ct,se,Oi,re,qe,Ge,Fi,Ue,Be,ze,Pi,Ke,En;return e=this,e[Mo](),i=s=1,e[Rr]===1||(i=s=0,e[Rr]=1),(!i||s&2)&&e.flagSelf$("cf-aj"),l=a=1,(o=e[Lr])||(l=a=0,e[Lr]=o=N("i-global",e,`cf-ak ${n}`,null)),c=o.slot$("__",e),l||(f=u("canvas",c,`cf-al ${n}`,null)),l||(f.id="matches"),(h=e[jr])||(e[jr]=(h=this.$forSave,h[pt]=c,h)),l||c[E](h),l||!o.setup||o.setup(a),o[k](a),l||e[E](o),i||(p=u("div",e,`cf-ao ${n}`,null)),i||(g=u("div",p,`cf-ap ${n}`,null)),m=T=1,(d=e[Hr])||(m=T=0,e[Hr]=d=N("title-box",g,`cf-aq ${n}`,null)),it=d.slot$("__",e),m||(d.title="Image Dropbox"),m||(st=u("div",it,`cf-ar ${n}`,null)),m||(Et=u("div",st,`cf-as ${n}`,null)),m||(I=u("p",Et,`cf-at ${n}`,"Left")),U=H=1,(b=e[Ar])||(U=H=0,e[Ar]=b=N("image-dropbox",Et,`cf-au ${n}`,null)),Gt=this.state.left,Gt===e[qr]||(b.image=e[qr]=Gt),b.useImageCallback=function(D,tt){return t.state.left=D,t.state.leftName=tt.name},U||!b.setup||b.setup(H),b[k](H),U||Et[E](b),m||(rt=u("div",st,`cf-av ${n}`,null)),m||(bt=u("p",rt,`cf-aw ${n}`,"Right")),nt=_t=1,(L=e[Gr])||(nt=_t=0,e[Gr]=L=N("image-dropbox",rt,`cf-ax ${n}`,null)),Ot=t.state.right,Ot===e[Ur]||(L.image=e[Ur]=Ot),L.useImageCallback=function(D,tt){return t.state.right=D,t.state.rightName=tt.name},nt||!L.setup||L.setup(_t),L[k](_t),nt||rt[E](L),m||(vi=u("div",it,`cf-ay ${n}`,null)),Oe=xi=1,(Ee=e[Br])||(Oe=xi=0,e[Br]=Ee=u("button",vi,`cf-az ${n}`,"Reset")),Fe=e[zr]||(e[zr]={$_:[function(D,tt,B){return B.reset(D)},null]}),Fe.$_[1]=t,Oe||Ee.on$("click",Fe,this),m||!d.setup||d.setup(T),d[k](T),m||g[E](d),ot=Ut=1,(K=e[Kr])||(ot=Ut=0,e[Kr]=K=N("title-box",g,`cf-ba ${n}`,null)),wi=K.slot$("__",e),ot||(K.title="Functions"),ot||(Bt=u("div",wi,`cf-bb ${n}`,null)),ke=$i=1,(Pe=e[Wr])||(ke=$i=0,e[Wr]=Pe=u("button",Bt,`cf-bc ${n}`,"Automatic align")),Ie=e[Jr]||(e[Jr]={$_:[function(D,tt,B){return B.processAlign(D)},null]}),Ie.$_[1]=t,ke||Pe.on$("click",Ie,this),ot||(Cn=u("br",Bt,`cf-bd ${n}`,null)),lt=Ci=1,(Ft=e[Yr])||(lt=Ci=0,e[Yr]=Ft=u("button",Bt,`cf-be ${n}`,null)),De=e[Qr]||(e[Qr]={$_:[function(D,tt,B){return B.swap(D)},null]}),De.$_[1]=t,lt||Ft.on$("click",De,this),lt||(Tn=u("div",Ft,`cf-bf ${n}`,"Left-right swap")),(yt=e[Xr])||(e[Xr]=yt=u("div",Ft,`cf-bg ${n}`,null)),lt||yt[qt]("(currently "),P.context=e[tn]||(e[tn]={_:yt}),Me=t.viewStatus(),P.context=null,Me===e[en]&&lt||(e[Zr]=yt[qt](e[en]=Me,0,e[Zr])),lt||yt[qt](")"),ot||!K.setup||K.setup(Ut),K[k](Ut),ot||g[E](K),A=zt=1,(W=e[sn])||(A=zt=0,e[sn]=W=N("title-box",g,`cf-bh ${n}`,null)),Ti=W.slot$("__",e),A||(W.title="Links"),A||(Ni=u("div",Ti,`cf-bi ${n}`,null)),A||(Kt=u("a",Ni,`cf-bj ${n}`,null)),A||(Kt.href="https://github.com/depthgallery/creator"),A||(Kt.target="_blank"),A||(Nn=u("p",Kt,`cf-bk ${n}`,"GitHub Repo")),A||!W.setup||W.setup(zt),W[k](zt),A||g[E](W),i||(Pt=u("div",p,`cf-bl ${n}`,null)),kt=Wt=1,(J=e[rn])||(kt=Wt=0,e[rn]=J=N("title-box",Pt,`cf-bm ${n}`,null)),Re=J.slot$("__",e),kt||(J.title="Result Image"),Jt=Yt=1,(at=e[nn])||(Jt=Yt=0,e[nn]=at=N("preview-canvas",Re,`cf-bn ${n}`,null)),Le=t.state,Le===e[on]||(at.alignmentState=e[on]=Le),Jt||!at.setup||at.setup(Yt),at[k](Yt),Jt||Re[E](at),kt||!J.setup||J.setup(Wt),J[k](Wt),kt||Pt[E](J),It=Qt=1,(Y=e[ln])||(It=Qt=0,e[ln]=Y=N("title-box",Pt,`cf-bo ${n}`,null)),Ve=Y.slot$("__",e),It||(Y.title="Adjustment (by mouse or arrow keys)"),Xt=Zt=1,(ht=e[an])||(Xt=Zt=0,e[an]=ht=N("adjustment-canvas",Ve,`cf-bp ${n}`,null)),je=t.state,je===e[hn]||(ht.alignmentState=e[hn]=je),Xt||!ht.setup||ht.setup(Zt),ht[k](Zt),Xt||Ve[E](ht),It||!Y.setup||Y.setup(Qt),Y[k](Qt),It||Pt[E](Y),i||(ut=u("div",p,`cf-bq ${n}`,null)),St=te=1,(Q=e[un])||(St=te=0,e[un]=Q=N("title-box",ut,`cf-br ${n}`,null)),He=Q.slot$("__",e),St||(Q.title="Logs"),(Dt=e[fn])||(e[fn]=(Dt=this.$logs,Dt[pt]=He,Dt)),St||He[E](Dt),St||!Q.setup||Q.setup(te),Q[k](te),St||ut[E](Q),vt=ee=1,(X=e[dn])||(vt=ee=0,e[dn]=X=N("title-box",ut,`cf-bt ${n}`,null)),Ei=X.slot$("__",e),vt||(X.title="Alignment Detail"),(ie=e[mn])||(e[mn]=ie=u("pre",Ei,`cf-bu ${n}`,null)),P.context=e[gn]||(e[gn]={_:ie}),Ae=t.metadata(t.state),P.context=null,Ae===e[bn]&&vt||(e[pn]=ie[qt](e[bn]=Ae,384,e[pn])),vt||!X.setup||X.setup(ee),X[k](ee),vt||ut[E](X),ct=se=1,(Z=e[_n])||(ct=se=0,e[_n]=Z=N("title-box",ut,`cf-bv ${n}`,null)),Oi=Z.slot$("__",e),ct||(Z.title="Export"),ct||(re=u("div",Oi,`cf-bw ${n}`,null)),Ge=Fi=1,(qe=e[yn])||(Ge=Fi=0,e[yn]=qe=u("button",re,`cf-bx ${n}`,"Download JPEG")),Ue=e[Sn]||(e[Sn]={$_:[function(D,tt,B){return B.downloadJPEG(D)},null]}),Ue.$_[1]=t,Ge||qe.on$("click",Ue,this),ze=Pi=1,(Be=e[vn])||(ze=Pi=0,e[vn]=Be=u("button",re,`cf-by ${n}`,"Download Separate JPEG")),Ke=e[xn]||(e[xn]={$_:[function(D,tt,B){return B.downloadSeparateJPEG(D)},null]}),Ke.$_[1]=t,ze||Be.on$("click",Ke,this),ct||(En=u("p",re,`cf-bz ${n}`,"You can also directly copy the result image.")),ct||!Z.setup||Z.setup(se),Z[k](se),ct||ut[E](Z),e[Ro](s),e}};q("app",$n,{});di((Te=Ne=1,(gt=Si[wn])||(Te=Ne=0,Si[wn]=gt=N("app",null,"cf-ca",null)),Te||(gt[pt]=Si._),Te||!gt.setup||gt.setup(Ne),gt[k](Ne),gt));
//__FOOT__
//# sourceMappingURL=/__assets__/app/client-PVPAJUBP.js.map
                      